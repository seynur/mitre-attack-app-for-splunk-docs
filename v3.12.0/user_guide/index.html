
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/img/seynur_logo.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.9">
    
    
      
        <title>User Guide - MITRE ATT&CK App for Splunk&reg;</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.20d9efc8.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.08040f6c.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/css/extra.css">
    
      <link rel="stylesheet" href="../assets/css/mitre.css">
    
      <link rel="stylesheet" href="../assets/css/mitre-utils.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mitre-attck-compliance-view" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="MITRE ATT&amp;CK App for Splunk&amp;reg;" class="md-header__button md-logo" aria-label="MITRE ATT&CK App for Splunk&reg;" data-md-component="logo">
      
  <img src="../assets/img/seynur_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MITRE ATT&CK App for Splunk&reg;
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              User Guide
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/seynur/DA-ESS-MitreContent" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    seynur/DA-ESS-MitreContent
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="MITRE ATT&amp;CK App for Splunk&amp;reg;" class="md-nav__button md-logo" aria-label="MITRE ATT&CK App for Splunk&reg;" data-md-component="logo">
      
  <img src="../assets/img/seynur_logo.png" alt="logo">

    </a>
    MITRE ATT&CK App for Splunk&reg;
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/seynur/DA-ESS-MitreContent" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    seynur/DA-ESS-MitreContent
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Get Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Get Started" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Get Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          User Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        User Guide
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mitre-attck-compliance-view" class="md-nav__link">
    MITRE ATT&amp;CK Compliance View
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mitre-attck-matrix-view" class="md-nav__link">
    MITRE ATT&amp;CK Matrix View
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mitre-attck-triggered-tactics-techniques-view" class="md-nav__link">
    MITRE ATT&amp;CK Triggered Tactics &amp; Techniques View
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-match-a-correlation-search-with-framework" class="md-nav__link">
    How To Match a Correlation Search with Framework
  </a>
  
    <nav class="md-nav" aria-label="How To Match a Correlation Search with Framework">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#match-with-analytic-story" class="md-nav__link">
    Match with Analytic Story
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#match-with-custom-correlation-search" class="md-nav__link">
    Match with Custom Correlation Search
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#match-with-lookup" class="md-nav__link">
    Match with Lookup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#match-with-dynamic-technique" class="md-nav__link">
    Match with Dynamic Technique
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          About
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../release_notes/" class="md-nav__link">
        Release Notes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mitre-attck-compliance-view" class="md-nav__link">
    MITRE ATT&amp;CK Compliance View
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mitre-attck-matrix-view" class="md-nav__link">
    MITRE ATT&amp;CK Matrix View
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mitre-attck-triggered-tactics-techniques-view" class="md-nav__link">
    MITRE ATT&amp;CK Triggered Tactics &amp; Techniques View
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-match-a-correlation-search-with-framework" class="md-nav__link">
    How To Match a Correlation Search with Framework
  </a>
  
    <nav class="md-nav" aria-label="How To Match a Correlation Search with Framework">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#match-with-analytic-story" class="md-nav__link">
    Match with Analytic Story
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#match-with-custom-correlation-search" class="md-nav__link">
    Match with Custom Correlation Search
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#match-with-lookup" class="md-nav__link">
    Match with Lookup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#match-with-dynamic-technique" class="md-nav__link">
    Match with Dynamic Technique
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/seynur/DA-ESS-MitreContent/edit/master/docs/user_guide.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


  <h1>User Guide</h1>

<p>This guide will provide description for the views that comes with this application and steps on how to create additional correlation searches.</p>
<p>&nbsp;</p>
<hr />
<p>&nbsp;</p>
<h3 id="mitre-attck-compliance-view">MITRE ATT&amp;CK Compliance View</h3>
<p>Each cell containing a technique/sub-technique is colored based on the percentage of enabled correlation searches.</p>
<p>If there isn't any related correlation searches, the cell is left uncolored.</p>
<p>If there are available correlation searches either within Enterprise Security (and ESCU) or as regular/custom saved searches with matching MITRE ATT&amp;CK techniques/sub-techniques, then cells are colored based on percentage of enabled/active ones.</p>
<p>Currently the ranges are set as follows:</p>
<ul>
<li>none: 0–30% (uncolored)</li>
<li>low: 30–50% enabled </li>
<li>medium: 50–70% enabled </li>
<li>high: 70%+ enabled</li>
</ul>
<p>You can mouse over to the cells that contain techniques/sub-techniques in order to view the number of available and enabled correlation rules that are specific to that technique/sub-technique.
<img alt="setup5" src="../assets/img/setup5.png" /></p>
<p>&nbsp;</p>
<hr />
<p>&nbsp;</p>
<h3 id="mitre-attck-matrix-view">MITRE ATT&amp;CK Matrix View</h3>
<p>This dashboard/form has filtering options based on "<strong>Event Time Range</strong>" and "<strong>Urgency</strong>" level and it provides and overview of triggered techniques within MITRE ATT&amp;CK Matrix colored according to the "<strong>Urgency</strong>" level of Notable Events populated index.</p>
<p>You can click on the triggered technique which provides the drill-down functionality.  Depending on your setup you will either drill-down via Enterprise Security App <strong>Incident Review</strong> view for further analysis/investigation.</p>
<p><img alt="triggered_techniques1" src="../assets/img/triggered_techniques1.png" /></p>
<p>&nbsp;</p>
<hr />
<p>&nbsp;</p>
<h3 id="mitre-attck-triggered-tactics-techniques-view">MITRE ATT&amp;CK Triggered Tactics &amp; Techniques View</h3>
<p>This dashboard/form provides an overview of triggered rules based on MITRE ATT&amp;CK Tactics and Notable assets/identities.  This is an effort to provide a better visibility for a notable asset/identity journey through MITRE ATT&amp;CK Framework.  The number of triggered Notable Events according to MITRE ATT&amp;CK techniques are aggregated by Notable Assets where <code>notable_asset</code> is populated by <code>src</code>, <code>dest</code> or <code>user</code> from related Data Models.</p>
<p>Currently following panels are available:</p>
<ol>
<li><strong>Triggered Tactics by Notable Assets</strong>: Shows an overview of number of triggered Notable Events according to MITRE ATT&amp;CK tactics by Notable Assets.  This is provided in both Sankey Diagram and Table formats.</li>
<li><strong>Triggered Tactics by Notable User</strong>: Shows an overview of number of triggered Notable Events according to MITRE ATT&amp;CK tactics by Notable User/Identity.  This is provided in both Sankey Diagram and Table formats.</li>
<li><strong>Triggered Techniques by Tactic</strong>: There's a separate panel for each MITRE ATT&amp;CK Framework Tactic that shows details on triggered Technique, associated correlation rule name, and count of occurrences.</li>
</ol>
<p><img alt="triggered_techniques2" src="../assets/img/triggered_techniques2.png" /></p>
<p><img alt="triggered_techniques3" src="../assets/img/triggered_techniques3.png" /></p>
<p><img alt="triggered_techniques4" src="../assets/img/triggered_techniques4.png" /></p>
<p>&nbsp;</p>
<hr />
<p>&nbsp;</p>
<h3 id="how-to-match-a-correlation-search-with-framework">How To Match a Correlation Search with Framework</h3>
<p>In order to view a saved/correlation search integrated with the MITRE ATT&amp;CK Matrix, following tasks need to be completed.</p>
<ol>
<li>alert action (ES) - triggered view TODO:</li>
<li>associate rule with technique TODO:</li>
</ol>
<p>There are 4 ways to accomplish this task.</p>
<ol>
<li><a href="#match-with-analytic-story">Match with Analytic Story</a>: Enable a new or existing <em>Analytic Story</em> to be tagged with the relevant <em>Correlation Search</em></li>
<li><a href="#match-with-custom-correlation-search">Match with Custom Correlation Search</a>: Enable a new or existing <em>Custom Correlation Search</em> with Content Management</li>
<li><a href="#match-with-lookup">Match with Lookup</a>: Edit the <code>mitre_user_rule_technique_lookup.csv</code> file.</li>
<li><a href="#match-with-dynamic-technique">Match with Dynamic Technique</a>: Add <code>annotations.mitre_attack.mitre_technique_id</code> multi-value field with technique IDs.</li>
</ol>
<h4 id="match-with-analytic-story">Match with Analytic Story</h4>
<p>The view in the application utilized <em>Analytic Stories</em> that are tagged with the <em>Correlation Searches</em>.  Hence, in order to associate a <em>Correlation Search</em> with MITRE ATT&amp;CK Techniques, you will need to create a new <em>Analytic Story</em> and add your <em>Correlation Search</em> with the appropriate tags.</p>
<p><strong>Note:</strong> Please go to Splunk Documentation on <a href="https://docs.splunk.com/Documentation/ES/latest/Admin/Createcorrelationsearches">How to create a Correlation Search</a></p>
<p>For example, if we want the <em>Correlation Search</em> "<strong>Brute Force Access Behavior Detected</strong>" to be associated with "<strong>Brute Force</strong>" Technique under "<strong>Credential Access</strong>" tactic, we need to perform the following steps:</p>
<ol>
<li>Go to "<strong>Configure --&gt; Content --&gt; Content Management</strong>" from Enterprise Security Application menu.  Click on "<strong>Create New Content</strong>" and select "<strong>Analytic Story</strong>"</li>
</ol>
<p><img alt="analyticstory1" src="../assets/img/analyticstory1.png" />
2. Enter a <strong>Name</strong> and fill other details as necessary for this analytic story.  Click on "<strong>Add Search</strong>" and select "<strong>Brute Force Access Behavior Detected</strong>"</p>
<p><img alt="analyticstory2" src="../assets/img/analyticstory2.png" />
   <img alt="analyticstory3" src="../assets/img/analyticstory3.png" />
3. Enter <code>detection</code> for <strong>Type</strong> field and under <strong>Annotations</strong>.</p>
<p><img alt="analyticstory4" src="../assets/img/analyticstory4.png" /></p>
<p>Click <code>Framework</code> and enter <code>mitre_attack</code> for <strong>Framework Name</strong>.</p>
<p><img alt="analyticstory5" src="../assets/img/analyticstory5.png" /></p>
<p><img alt="analyticstory6" src="../assets/img/analyticstory6.png" /></p>
<p>Enter <code>Brute Force</code> for <strong>Mappings</strong> (this should match the technique).</p>
<p><img alt="analyticstory7" src="../assets/img/analyticstory7.png" />
4. Click <strong>Save</strong> to save the <em>Analytic Story</em> with annotation and mapping with the defined correlation search.  You can add many correlation searches under one analytic story with defined mappings.</p>
<p>Once you’re done with the <strong>Analytic Story</strong>, you may want to run Lookup File Generation manually in order to generate the overall lookup files or wait until the scheduled searches run. After lookup file generation, the correlation search will populate both the Compliance and Triggered Techniques dashboards.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h4 id="match-with-custom-correlation-search">Match with Custom Correlation Search</h4>
<p>Splunk Enterprise Security 6.4.x provides MITRE ATT&amp;CK annotation in correlation searches that map to techniques/sub-techniques. These mappings are integrated into both the Compliance and Triggered Techniques dashboards.</p>
<p>&nbsp;</p>
<p><strong>Note:</strong> Please go to Splunk Documentation on <a href="https://docs.splunk.com/Documentation/ES/latest/Admin/Createcorrelationsearches">How to create a Correlation Search</a></p>
<p>&nbsp;</p>
<p>For example, if we want the a <em>Correlation Search</em> to be associated with one or more techniques, we need to perform the following steps:</p>
<p>&nbsp;</p>
<ol>
<li>Go to "<strong>Configure --&gt; Content --&gt; Content Management</strong>" from Enterprise Security Application menu.  Click on "<strong>Create New Content</strong>" and select "<strong>Correlation Search</strong>"</li>
</ol>
<p><img alt="contentmanagement1" src="../assets/img/contentmanagement1.png" />
   <img alt="contentmanagement2" src="../assets/img/contentmanagement2.png" />
2. Enter a <strong>Name</strong> and fill other details as necessary for this correlation search.  Add your custom search.</p>
<p><img alt="contentmanagement3" src="../assets/img/contentmanagement3.png" />
3. Enter MITRE ATT&amp;CK techniques/sub-techniques in the <strong>Annotations</strong> section.</p>
<p><img alt="contentmanagement4" src="../assets/img/contentmanagement4.png" /></p>
<p>&nbsp;</p>
<p>Once you’re done with the <strong>Correlation Search</strong>, you may want to run Lookup File Generation manually in order to generate the overall lookup files or wait until the scheduled searches run. After lookup file generation, the correlation search will populate both the Compliance and Triggered Techniques dashboards.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h4 id="match-with-lookup">Match with Lookup</h4>
<p>Each correlation rule is associated with 1 or more technique IDs.  For a given correlation rule you if you simply want to add the technique ID(s), then you have 2 choices:</p>
<ol>
<li>
<p>Utilize <strong>Map Rule to Technique</strong> views</p>
<p><em>OR</em></p>
</li>
<li>
<p>Edit <code>mitre_user_rule_technique_lookup.csv</code> directly.  </p>
</li>
</ol>
<p><strong>NOTE:</strong> The scheduled searches combine this lookup along with analytic stories and checks against existing saved/correlation searches in order to create <code>mitre_all_rule_technique_lookup.csv</code>, which is used within the app.</p>
<hr />
<p><strong>(1)</strong> Utilize <strong>Map Rule to Technique</strong> views</p>
<ul>
<li>Go to "<strong>Configuration --&gt; Map Rule to Technique</strong>" from MITRE ATT&amp;CK Framework App menu.  Initially it should appear something similar to following image.</li>
</ul>
<p><img alt="map_rule_to_technique1" src="../assets/img/map_rule_to_technique1.png" /></p>
<p><em><strong>Panel Descriptions</strong></em>:</p>
<p><strong>Existing User Defined Mappings</strong>: This panel displays the contents of user defined mappings and refreshed every 30 seconds to display updates.</p>
<p><strong>Newly Added User Defined Mapping</strong>: This panel displays the newly selected rule-to-technique mapping which is added to the lookup table.</p>
<p>&nbsp;</p>
<ul>
<li>Next, select the rule name form <strong>Rule Name</strong> dropdown menu item and associate with technique IDs from <strong>MITRE ATT&amp;CK Technique</strong> multi-select then hit <strong>Submit</strong>.  Both panels will be updated accordingly. Once you're done with mappings and updates, you may want to run <strong>Lookup File Generation</strong> manually in order to generate the overall lookup files or wait until the scheduled searches run.</li>
</ul>
<p><img alt="map_rule_to_technique2" src="../assets/img/map_rule_to_technique2.png" /></p>
<p><strong>Note:</strong> Splunk is equipped with security safeguards in its SPL to alert users when attempting to execute a search in Splunk Web that includes commands deemed potentially risky. If a <a href="https://docs.splunk.com/Documentation/Splunk/9.1.1/Security/SPLsafeguards#Commands_that_trigger_SPL_safeguards">search command</a> falls into this category and triggers the safeguard, a warning dialog box will pop up (Splunk version 9.0 and above), offering additional information for review. Users are given the choice to acknowledge the potential risks and proceed with running the query.</p>
<p><img alt="map_rule_to_technique3" src="../assets/img/map_rule_to_technique3.png" /></p>
<p><img alt="map_rule_to_technique4" src="../assets/img/map_rule_to_technique4.png" /></p>
<p><img alt="map_rule_to_technique5" src="../assets/img/map_rule_to_technique5.png" /></p>
<p><strong>Important NOTE</strong>: If a rule name is already defined, this view does NOT add any mappings to the lookup in order to avoid duplicates.  You will see <code>No results found</code> message and will need to edit the lookup table manually.</p>
<p>&nbsp;</p>
<p><strong>(2)</strong> Edit <code>mitre_user_rule_technique_lookup.csv</code> directly.<br />
You can edit the csv directly or utilize Lookup Editor app from web interface.</p>
<p><img alt="lookup_editor1" src="../assets/img/lookup_editor1.png" /></p>
<p>The lookup file expects 2 fields:</p>
<ul>
<li><code>rule_name</code> : The rule name as it appears in <code>savedsearches.conf</code> (e.g. "Access - Excessive Failed Logins - Rule")</li>
<li><code>technique_id</code> : MITRE ATT&amp;CK Technique ID (e.g. T1078 for Valid Accounts) list separated by spaces</li>
</ul>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h4 id="match-with-dynamic-technique">Match with Dynamic Technique</h4>
<p>It's possible to dynamically match your triggered events (notable or alert) by simply adding <code>annotations.mitre_attack.mitre_technique_id</code> multi-value field to search results.</p>
<div class="highlight"><pre><span></span><code>| tstats ...
| eval annotations.mitre_attack.mitre_technique_id=&quot;T1189&quot;
</code></pre></div>
<hr />





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../installation/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Installation" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Installation
            </div>
          </div>
        </a>
      
      
        
        <a href="../release_notes/" class="md-footer__link md-footer__link--next" aria-label="Next: Release Notes" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Release Notes
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 - Seynur All rights reserved.
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://tr.linkedin.com/company/seynur?original_referer=https%3A%2F%2Fwww.google.com%2F" target="_blank" rel="noopener" title="tr.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d6c3db9e.min.js"></script>
      
    
  </body>
</html>